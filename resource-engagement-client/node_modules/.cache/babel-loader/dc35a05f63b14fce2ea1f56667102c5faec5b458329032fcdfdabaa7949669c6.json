{"ast":null,"code":"import axios from 'axios';\nconst API_BASE_URL = 'http://localhost:5000/api/auth';\nclass ApiService {\n  constructor() {\n    this.api = axios.create({\n      baseURL: API_BASE_URL,\n      headers: {\n        'Content-Type': 'application/json'\n      }\n    });\n    // Add request interceptor to include auth token\n    this.api.interceptors.request.use(config => {\n      const token = localStorage.getItem('authToken');\n      if (token) {\n        config.headers.Authorization = `Bearer ${token}`;\n      }\n      return config;\n    });\n\n    // Add response interceptor to handle errors\n    this.api.interceptors.response.use(response => response, error => {\n      var _error$response;\n      if (((_error$response = error.response) === null || _error$response === void 0 ? void 0 : _error$response.status) === 401) {\n        var _error$config;\n        // Don't redirect on 2FA verification errors - let the component handle it\n        const url = (_error$config = error.config) === null || _error$config === void 0 ? void 0 : _error$config.url;\n        if (url && url.includes('/2fa/verify')) {\n          return Promise.reject(error);\n        }\n        localStorage.removeItem('authToken');\n        localStorage.removeItem('user');\n        window.location.href = '/login';\n      }\n      return Promise.reject(error);\n    });\n  }\n\n  // Authentication endpoints\n  async register(data) {\n    const response = await this.api.post('/register', data);\n    return response.data;\n  }\n  async login(data) {\n    const response = await this.api.post('/login', data);\n    return response.data;\n  }\n  async logout() {\n    const response = await this.api.post('/logout');\n    return response.data;\n  }\n\n  // Profile endpoints\n  async getProfile() {\n    const response = await this.api.get('/profile');\n    return response.data;\n  }\n  async updateProfile(data) {\n    const response = await this.api.put('/profile', data);\n    return response.data;\n  }\n\n  // 2FA endpoints\n  async get2FASetup() {\n    const response = await this.api.get('/2fa/setup');\n    return response.data;\n  }\n  async enable2FA(data) {\n    const response = await this.api.post('/2fa/enable', data);\n    return response.data;\n  }\n  async verify2FA(data) {\n    const response = await this.api.post('/2fa/verify', data);\n    return response.data;\n  }\n  async get2FAStatus() {\n    const response = await this.api.get('/2fa/status');\n    return response.data;\n  }\n  async disable2FA(data) {\n    const response = await this.api.post('/2fa/disable', data);\n    return response.data;\n  }\n\n  // Helper methods\n  setAuthToken(token) {\n    localStorage.setItem('authToken', token);\n  }\n  removeAuthToken() {\n    localStorage.removeItem('authToken');\n    localStorage.removeItem('user');\n  }\n  getAuthToken() {\n    return localStorage.getItem('authToken');\n  }\n  isAuthenticated() {\n    return !!this.getAuthToken();\n  }\n}\nexport const apiService = new ApiService();","map":{"version":3,"names":["axios","API_BASE_URL","ApiService","constructor","api","create","baseURL","headers","interceptors","request","use","config","token","localStorage","getItem","Authorization","response","error","_error$response","status","_error$config","url","includes","Promise","reject","removeItem","window","location","href","register","data","post","login","logout","getProfile","get","updateProfile","put","get2FASetup","enable2FA","verify2FA","get2FAStatus","disable2FA","setAuthToken","setItem","removeAuthToken","getAuthToken","isAuthenticated","apiService"],"sources":["C:/Users/piyushsinghjc/Downloads/AuthMicroservice/auth-client/src/services/api.ts"],"sourcesContent":["import axios, { AxiosResponse } from 'axios';\r\nimport {\r\n  User,\r\n  RegisterRequest,\r\n  LoginRequest,\r\n  LoginResponse,\r\n  UpdateProfileRequest,\r\n  TwoFactorSetup,\r\n  TwoFactorVerifyRequest,\r\n  EnableTwoFactorRequest,\r\n  ApiError\r\n} from '../types';\r\n\r\nconst API_BASE_URL = 'http://localhost:5000/api/auth';\r\n\r\nclass ApiService {\r\n  private api = axios.create({\r\n    baseURL: API_BASE_URL,\r\n    headers: {\r\n      'Content-Type': 'application/json',\r\n    },\r\n  });\r\n\r\n  constructor() {\r\n    // Add request interceptor to include auth token\r\n    this.api.interceptors.request.use((config) => {\r\n      const token = localStorage.getItem('authToken');\r\n      if (token) {\r\n        config.headers.Authorization = `Bearer ${token}`;\r\n      }\r\n      return config;\r\n    });\r\n\r\n    // Add response interceptor to handle errors\r\n    this.api.interceptors.response.use(\r\n      (response) => response,\r\n      (error) => {\r\n        if (error.response?.status === 401) {\r\n          // Don't redirect on 2FA verification errors - let the component handle it\r\n          const url = error.config?.url;\r\n          if (url && url.includes('/2fa/verify')) {\r\n            return Promise.reject(error);\r\n          }\r\n          \r\n          localStorage.removeItem('authToken');\r\n          localStorage.removeItem('user');\r\n          window.location.href = '/login';\r\n        }\r\n        return Promise.reject(error);\r\n      }\r\n    );\r\n  }\r\n\r\n  // Authentication endpoints\r\n  async register(data: RegisterRequest): Promise<{ message: string; userId: string }> {\r\n    const response: AxiosResponse = await this.api.post('/register', data);\r\n    return response.data;\r\n  }\r\n\r\n  async login(data: LoginRequest): Promise<LoginResponse> {\r\n    const response: AxiosResponse = await this.api.post('/login', data);\r\n    return response.data;\r\n  }\r\n\r\n  async logout(): Promise<{ message: string }> {\r\n    const response: AxiosResponse = await this.api.post('/logout');\r\n    return response.data;\r\n  }\r\n\r\n  // Profile endpoints\r\n  async getProfile(): Promise<User> {\r\n    const response: AxiosResponse = await this.api.get('/profile');\r\n    return response.data;\r\n  }\r\n\r\n  async updateProfile(data: UpdateProfileRequest): Promise<{ message: string; profile: User }> {\r\n    const response: AxiosResponse = await this.api.put('/profile', data);\r\n    return response.data;\r\n  }\r\n\r\n  // 2FA endpoints\r\n  async get2FASetup(): Promise<TwoFactorSetup> {\r\n    const response: AxiosResponse = await this.api.get('/2fa/setup');\r\n    return response.data;\r\n  }\r\n\r\n  async enable2FA(data: EnableTwoFactorRequest): Promise<{ message: string; twoFactorEnabled: boolean }> {\r\n    const response: AxiosResponse = await this.api.post('/2fa/enable', data);\r\n    return response.data;\r\n  }\r\n\r\n  async verify2FA(data: TwoFactorVerifyRequest): Promise<LoginResponse> {\r\n    const response: AxiosResponse = await this.api.post('/2fa/verify', data);\r\n    return response.data;\r\n  }\r\n\r\n  async get2FAStatus(): Promise<{ twoFactorEnabled: boolean }> {\r\n    const response: AxiosResponse = await this.api.get('/2fa/status');\r\n    return response.data;\r\n  }\r\n\r\n  async disable2FA(data: { code: string }): Promise<{ message: string; twoFactorEnabled: boolean }> {\r\n    const response: AxiosResponse = await this.api.post('/2fa/disable', data);\r\n    return response.data;\r\n  }\r\n\r\n  // Helper methods\r\n  setAuthToken(token: string): void {\r\n    localStorage.setItem('authToken', token);\r\n  }\r\n\r\n  removeAuthToken(): void {\r\n    localStorage.removeItem('authToken');\r\n    localStorage.removeItem('user');\r\n  }\r\n\r\n  getAuthToken(): string | null {\r\n    return localStorage.getItem('authToken');\r\n  }\r\n\r\n  isAuthenticated(): boolean {\r\n    return !!this.getAuthToken();\r\n  }\r\n}\r\n\r\nexport const apiService = new ApiService();"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}